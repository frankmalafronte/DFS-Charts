language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "dfs-charts-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: dfs-charts # see README
  api_key:
    secure: KKgbjgtN25zibBNkr0ISdHb1PxL7KC8T8pYQ2SiG3Aw9UbVtC66DBHTaz4Yh0FWmdK5X0Pledm7r3p+w8NHNHYJxPsEBgev6rdHrjE7+ezzfrQ4fwDgFVD7APKAjN8x0N5lN83CZw2NG0baKgqD9+5UXCpmfTwPbf9Kk65tblf6xxOr657/H5xpOysrJjN01QG+nHrcohjX+FbmEWV/0cJpj7OgV1CLcaTuqcrY4C3RXAp00Xvmo6uko/CQkMnvk824HJVZKF7t7thmMc+bz9UqSRvV1OZtxoXGinFEtv12flzXaFjyB4Sh/Lqid/1Q+mhUgSZxlxa7XDF6O7RZzdlr/s3gnY11dA7vPYfoAYnz5tip+ZYbbaLEeXm852lvRaGfYfrTzxvh1Cb91XskKOJ2duksGIzWFrJ3+Jj72YzA7bwGHsrCz5aEKf0bbanPQtG3i/HjzL9297Kn+1N6EW5Pd92g4itkLzNG60O+QLEzGaFQ1iud/hCnnh9tftg8soU39Sfkg+U6a7C1WdF4a4niR+bs+7zGcOOuMSstm5G1YM0pYxYfguKGjhHuZG+B0dC8GY0fQhfw0J4A6xli6pkLkYwqYQWc4BaBqdjmsOqNeW7/07bHa9PqHRj91IOj71jyXvc55Xxr7jrluDRiouG2RcB3IaSSv34qu/C5ooms= # see README
